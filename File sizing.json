{"paragraphs":[{"text":"%spark2.pyspark\nimport pandas as pd\nimport urllib\nimport glob\nimport gc\n\npd.set_option('display.expand_frame_repr', True)\npd.options.display.max_columns = None\n\n# Collect all data to one Pandas Dataframe\nlist_usage = []\npath ='/home/hadoop/TFL_Cycling_Data_raw/usage-stats_example'\nallFiles = glob.glob(path + \"/*.csv\")\nfor file_ in allFiles:\n    df = pd.read_csv(file_,index_col=None, header=0)\n    list_usage.append(df)\n    gc.collect()\n\ncycleusage_df = pd.concat(list_usage, axis = 0, sort=False, ignore_index = True)\ncycleusage_df = cycleusage_df.fillna(value=0)\ncycleusage_df.head()\n#Causes problem -> out of memory because we don't have around 5 GB storage left anymore.\n","user":"admin","dateUpdated":"2019-01-15T22:22:14+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547070223496_-1879193221","id":"20190109-224343_58266271","dateCreated":"2019-01-09T22:43:43+0100","dateStarted":"2019-01-09T22:47:46+0100","dateFinished":"2019-01-09T22:49:09+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4435"},{"text":"%md\n###File sizing###\nProblem: too many files for one dataframe (size bigger then free memory allocation).\nIdea: put each single file into a new folder on the HDFS and use Spark for reading file by file.\n- Data munging (i.e. remove unused columns for saving memory, get coordinates, merge frames)\n- Use read parallelize method of Spark API\n- Convert RDD to DF and save it back to HDFS\n","user":"admin","dateUpdated":"2019-01-15T22:23:57+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>File sizing</h3>\n<p>Problem: too many files for one dataframe (size bigger then free memory allocation).\n<br  />Idea: put each single file into a new folder on the HDFS and use Spark for reading file by file.</p>\n<ul>\n<li>Data munging (i.e. remove unused columns for saving memory, get coordinates, merge frames)</li>\n<li>Use read parallelize method of Spark API</li>\n<li>Convert RDD to DF and save it back to HDFS</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1547076425614_-1012665633","id":"20190110-002705_654640941","dateCreated":"2019-01-10T00:27:05+0100","dateStarted":"2019-01-15T22:23:57+0100","dateFinished":"2019-01-15T22:23:57+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4436"},{"text":"%sh\n\n# Remove old dataset if already exists in hadoop /user/hadoop directory\nd_name=/user/hadoop/usage-stats/\n\nhdfs dfs -test -d $d_name\n    if [ $? != 0 ]\n            then\n                echo \"Move folder to HDFS...\"\n                hdfs dfs -put /home/hadoop/TFL_Cycling_Data_raw/usage-stats /user/hadoop/usage-stats\n                echo \"Folder successfully uploaded to HDFS\"\n                hdfs dfs -ls $d_name\n            else\n                echo \"Directory already present in HDFS\"\n                echo \"Move folder to trash\"\n                hdfs dfs -rm -r -skipTrash $d_name\n                echo \"$d_name\" \"has been deleted\"\n    fi","user":"admin","dateUpdated":"2019-01-14T16:54:02+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Move folder to HDFS...\nFolder successfully uploaded to HDFS\nFound 160 items\n-rw-r--r--   3 zeppelin hdfs   34451153 2019-01-14 01:43 /user/hadoop/usage-stats/01aJourneyDataExtract10Jan16-23Jan16.csv\n-rw-r--r--   3 zeppelin hdfs   35486081 2019-01-14 01:43 /user/hadoop/usage-stats/01b Journey Data Extract 24Jan16-06Feb16.csv\n-rw-r--r--   3 zeppelin hdfs   35486081 2019-01-14 01:43 /user/hadoop/usage-stats/01bJourneyDataExtract24Jan16-06Feb16.csv\n-rw-r--r--   3 zeppelin hdfs   33287674 2019-01-14 01:43 /user/hadoop/usage-stats/02aJourneyDataExtract07Fe16-20Feb2016.csv\n-rw-r--r--   3 zeppelin hdfs   34882871 2019-01-14 01:43 /user/hadoop/usage-stats/02bJourneyDataExtract21Feb16-05Mar2016.csv\n-rw-r--r--   3 zeppelin hdfs   67717329 2019-01-14 01:43 /user/hadoop/usage-stats/03JourneyDataExtract06Mar2016-31Mar2016.csv\n-rw-r--r--   3 zeppelin hdfs   94572397 2019-01-14 01:43 /user/hadoop/usage-stats/04JourneyDataExtract01Apr2016-30Apr2016.csv\n-rw-r--r--   3 zeppelin hdfs   71655072 2019-01-14 01:43 /user/hadoop/usage-stats/05JourneyDataExtract01May2016-17May2016.csv\n-rw-r--r--   3 zeppelin hdfs   27903078 2019-01-14 01:43 /user/hadoop/usage-stats/06JourneyDataExtract18May2016-24May2016.csv\n-rw-r--r--   3 zeppelin hdfs   25920903 2019-01-14 01:43 /user/hadoop/usage-stats/07JourneyDataExtract25May2016-31May2016.csv\n-rw-r--r--   3 zeppelin hdfs   28771414 2019-01-14 01:43 /user/hadoop/usage-stats/08JourneyDataExtract01Jun2016-07Jun2016.csv\n-rw-r--r--   3 zeppelin hdfs   27477331 2019-01-14 01:43 /user/hadoop/usage-stats/09JourneyDataExtract08Jun2016-14Jun2016.csv\n-rw-r--r--   3 zeppelin hdfs   11698458 2019-01-14 01:43 /user/hadoop/usage-stats/103JourneyDataExtract28Mar2018-03Apr2018.csv\n-rw-r--r--   3 zeppelin hdfs   19569924 2019-01-14 01:43 /user/hadoop/usage-stats/104JourneyDataExtract04Apr2018-10Apr2018.csv\n-rw-r--r--   3 zeppelin hdfs   23764410 2019-01-14 01:43 /user/hadoop/usage-stats/105JourneyDataExtract11Apr2018-17Apr2018.csv\n-rw-r--r--   3 zeppelin hdfs   33599248 2019-01-14 01:43 /user/hadoop/usage-stats/106JourneyDataExtract18Apr2018-24Apr2018.csv\n-rw-r--r--   3 zeppelin hdfs   20983000 2019-01-14 01:43 /user/hadoop/usage-stats/107JourneyDataExtract25Apr2018-01May2018.csv\n-rw-r--r--   3 zeppelin hdfs   31624193 2019-01-14 01:43 /user/hadoop/usage-stats/108JourneyDataExtract02May2018-08May2018.csv\n-rw-r--r--   3 zeppelin hdfs   29317958 2019-01-14 01:43 /user/hadoop/usage-stats/109JourneyDataExtract09May2018-15May2018.csv\n-rw-r--r--   3 zeppelin hdfs   27103628 2019-01-14 01:43 /user/hadoop/usage-stats/10JourneyDataExtract15Jun2016-21Jun2016.csv\n-rw-r--r--   3 zeppelin hdfs   53052751 2019-01-14 01:43 /user/hadoop/usage-stats/10a-Journey-Data-Extract-20Sep15-03Oct15.csv\n-rw-r--r--   3 zeppelin hdfs   49626229 2019-01-14 01:43 /user/hadoop/usage-stats/10b-Journey-Data-Extract-04Oct15-17Oct15.csv\n-rw-r--r--   3 zeppelin hdfs   32103278 2019-01-14 01:43 /user/hadoop/usage-stats/110JourneyDataExtract16May2018-22May2018.csv\n-rw-r--r--   3 zeppelin hdfs   28111400 2019-01-14 01:43 /user/hadoop/usage-stats/111JourneyDataExtract23May2018-29May2018.csv\n-rw-r--r--   3 zeppelin hdfs   31383816 2019-01-14 01:43 /user/hadoop/usage-stats/112JourneyDataExtract30May2018-05June2018.csv\n-rw-r--r--   3 zeppelin hdfs   32989219 2019-01-14 01:43 /user/hadoop/usage-stats/113JourneyDataExtract06June2018-12June2018.csv\n-rw-r--r--   3 zeppelin hdfs   31084740 2019-01-14 01:43 /user/hadoop/usage-stats/114JourneyDataExtract13June2018-19June2018.csv\n-rw-r--r--   3 zeppelin hdfs   35340649 2019-01-14 01:43 /user/hadoop/usage-stats/115JourneyDataExtract20June2018-26June2018.csv\n-rw-r--r--   3 zeppelin hdfs   35471699 2019-01-14 01:43 /user/hadoop/usage-stats/116JourneyDataExtract27June2018-03July2018.csv\n-rw-r--r--   3 zeppelin hdfs   35034559 2019-01-14 01:43 /user/hadoop/usage-stats/117JourneyDataExtract04July2018-10July2018.csv\n-rw-r--r--   3 zeppelin hdfs   34344069 2019-01-14 01:43 /user/hadoop/usage-stats/118JourneyDataExtract11July2018-17July2018.csv\n-rw-r--r--   3 zeppelin hdfs   34922018 2019-01-14 01:43 /user/hadoop/usage-stats/119JourneyDataExtract18July2018-24July2018.csv\n-rw-r--r--   3 zeppelin hdfs   27282325 2019-01-14 01:43 /user/hadoop/usage-stats/11JourneyDataExtract22Jun2016-28Jun2016.csv\n-rw-r--r--   3 zeppelin hdfs   44970052 2019-01-14 01:43 /user/hadoop/usage-stats/11a-Journey-Data-Extract-18Oct15-31Oct15.csv\n-rw-r--r--   3 zeppelin hdfs   41144797 2019-01-14 01:43 /user/hadoop/usage-stats/11b-Journey-Data-Extract-01Nov15-14Nov15.csv\n-rw-r--r--   3 zeppelin hdfs   31772001 2019-01-14 01:43 /user/hadoop/usage-stats/120JourneyDataExtract25July2018-31July2018.csv\n-rw-r--r--   3 zeppelin hdfs   35021999 2019-01-14 01:43 /user/hadoop/usage-stats/121JourneyDataExtract01Aug2018-07Aug2018.csv\n-rw-r--r--   3 zeppelin hdfs   27192201 2019-01-14 01:43 /user/hadoop/usage-stats/122JourneyDataExtract08Aug2018-14Aug2018.csv\n-rw-r--r--   3 zeppelin hdfs   29937814 2019-01-14 01:43 /user/hadoop/usage-stats/123JourneyDataExtract15Aug2018-21Aug2018.csv\n-rw-r--r--   3 zeppelin hdfs   23412636 2019-01-14 01:43 /user/hadoop/usage-stats/124JourneyDataExtract22Aug2018-28Aug2018.csv\n-rw-r--r--   3 zeppelin hdfs   29254055 2019-01-14 01:43 /user/hadoop/usage-stats/125JourneyDataExtract29Aug2018-04Sep2018.csv\n-rw-r--r--   3 zeppelin hdfs   28857237 2019-01-14 01:43 /user/hadoop/usage-stats/126JourneyDataExtract05Sep2018-11Sep2018.csv\n-rw-r--r--   3 zeppelin hdfs   30181508 2019-01-14 01:43 /user/hadoop/usage-stats/127JourneyDataExtract12Sep2018-18Sep2018.csv\n-rw-r--r--   3 zeppelin hdfs   24268772 2019-01-14 01:43 /user/hadoop/usage-stats/128JourneyDataExtract19Sep2018-25Sep2018.csv\n-rw-r--r--   3 zeppelin hdfs   29674143 2019-01-14 01:43 /user/hadoop/usage-stats/12JourneyDataExtract29Jun2016-05Jul2016.csv\n-rw-r--r--   3 zeppelin hdfs   35179761 2019-01-14 01:43 /user/hadoop/usage-stats/12aJourneyDataExtract15Nov15-27Nov15.csv\n-rw-r--r--   3 zeppelin hdfs   39630539 2019-01-14 01:43 /user/hadoop/usage-stats/12bJourneyDataExtract28Nov15-12Dec15.csv\n-rw-r--r--   3 zeppelin hdfs   29899103 2019-01-14 01:43 /user/hadoop/usage-stats/13JourneyDataExtract06Jul2016-12Jul2016.csv\n-rw-r--r--   3 zeppelin hdfs   28981434 2019-01-14 01:43 /user/hadoop/usage-stats/13aJourneyDataExtract13Dec15-24Dec15.csv\n-rw-r--r--   3 zeppelin hdfs   30064333 2019-01-14 01:43 /user/hadoop/usage-stats/13bJourneyDataExtract25Dec15-09Jan16.csv\n-rw-r--r--   3 zeppelin hdfs   34977660 2019-01-14 01:43 /user/hadoop/usage-stats/14JourneyDataExtract13Jul2016-19Jul2016.csv\n-rw-r--r--   3 zeppelin hdfs   35583327 2019-01-14 01:43 /user/hadoop/usage-stats/15JourneyDataExtract20Jul2016-26Jul2016.csv\n-rw-r--r--   3 zeppelin hdfs   32360902 2019-01-14 01:43 /user/hadoop/usage-stats/16JourneyDataExtract27Jul2016-02Aug2016.csv\n-rw-r--r--   3 zeppelin hdfs   33998852 2019-01-14 01:43 /user/hadoop/usage-stats/17JourneyDataExtract03Aug2016-09Aug2016.csv\n-rw-r--r--   3 zeppelin hdfs   35101289 2019-01-14 01:43 /user/hadoop/usage-stats/18JourneyDataExtract10Aug2016-16Aug2016.csv\n-rw-r--r--   3 zeppelin hdfs   29162758 2019-01-14 01:43 /user/hadoop/usage-stats/19JourneyDataExtract17Aug2016-23Aug2016.csv\n-rw-r--r--   3 zeppelin hdfs   32091911 2019-01-14 01:43 /user/hadoop/usage-stats/1a.JourneyDataExtract04Jan15-17Jan15.csv\n-rw-r--r--   3 zeppelin hdfs   34103997 2019-01-14 01:44 /user/hadoop/usage-stats/1b.JourneyDataExtract18Jan15-31Jan15.csv\n-rw-r--r--   3 zeppelin hdfs  208701113 2019-01-14 01:44 /user/hadoop/usage-stats/2015TripDatazip.zip\n-rw-r--r--   3 zeppelin hdfs  222067537 2019-01-14 01:44 /user/hadoop/usage-stats/2016TripDataZip.zip\n-rw-r--r--   3 zeppelin hdfs   30509039 2019-01-14 01:44 /user/hadoop/usage-stats/20JourneyDataExtract24Aug2016-30Aug2016.csv\n-rw-r--r--   3 zeppelin hdfs   29461893 2019-01-14 01:44 /user/hadoop/usage-stats/21JourneyDataExtract31Aug2016-06Sep2016.csv\n-rw-r--r--   3 zeppelin hdfs   31357377 2019-01-14 01:44 /user/hadoop/usage-stats/22JourneyDataExtract07Sep2016-13Sep2016.csv\n-rw-r--r--   3 zeppelin hdfs   28847793 2019-01-14 01:44 /user/hadoop/usage-stats/23JourneyDataExtract14Sep2016-20Sep2016.csv\n-rw-r--r--   3 zeppelin hdfs   30932775 2019-01-14 01:44 /user/hadoop/usage-stats/24JourneyDataExtract21Sep2016-27Sep2016.csv\n-rw-r--r--   3 zeppelin hdfs   27343703 2019-01-14 01:44 /user/hadoop/usage-stats/25JourneyDataExtract28Sep2016-04Oct2016.csv\n-rw-r--r--   3 zeppelin hdfs   27338225 2019-01-14 01:44 /user/hadoop/usage-stats/26JourneyDataExtract05Oct2016-11Oct2016.csv\n-rw-r--r--   3 zeppelin hdfs   24271970 2019-01-14 01:44 /user/hadoop/usage-stats/27JourneyDataExtract12Oct2016-18Oct2016.csv\n-rw-r--r--   3 zeppelin hdfs   25570755 2019-01-14 01:44 /user/hadoop/usage-stats/28JourneyDataExtract19Oct2016-25Oct2016.csv\n-rw-r--r--   3 zeppelin hdfs   26860667 2019-01-14 01:44 /user/hadoop/usage-stats/29JourneyDataExtract26Oct2016-01Nov2016.csv\n-rw-r--r--   3 zeppelin hdfs   32961852 2019-01-14 01:44 /user/hadoop/usage-stats/2a.JourneyDataExtract01Feb15-14Feb15.csv\n-rw-r--r--   3 zeppelin hdfs   32811094 2019-01-14 01:44 /user/hadoop/usage-stats/2b.JourneyDataExtract15Feb15-28Feb15.csv\n-rw-r--r--   3 zeppelin hdfs   19636191 2019-01-14 01:44 /user/hadoop/usage-stats/30JourneyDataExtract02Nov2016-08Nov2016.csv\n-rw-r--r--   3 zeppelin hdfs   18801936 2019-01-14 01:44 /user/hadoop/usage-stats/31JourneyDataExtract09Nov2016-15Nov2016.csv\n-rw-r--r--   3 zeppelin hdfs   19129013 2019-01-14 01:44 /user/hadoop/usage-stats/32JourneyDataExtract16Nov2016-22Nov2016.csv\n-rw-r--r--   3 zeppelin hdfs   21182586 2019-01-14 01:44 /user/hadoop/usage-stats/33JourneyDataExtract23Nov2016-29Nov2016.csv\n-rw-r--r--   3 zeppelin hdfs   20338179 2019-01-14 01:44 /user/hadoop/usage-stats/34JourneyDataExtract30Nov2016-06Dec2016.csv\n-rw-r--r--   3 zeppelin hdfs   20959011 2019-01-14 01:44 /user/hadoop/usage-stats/35JourneyDataExtract07Dec2016-13Dec2016.csv\n-rw-r--r--   3 zeppelin hdfs   20169339 2019-01-14 01:44 /user/hadoop/usage-stats/36JourneyDataExtract14Dec2016-20Dec2016.csv\n-rw-r--r--   3 zeppelin hdfs   15407215 2019-01-14 01:44 /user/hadoop/usage-stats/37JourneyDataExtract21Dec2016-27Dec2016.csv\n-rw-r--r--   3 zeppelin hdfs   10688750 2019-01-14 01:44 /user/hadoop/usage-stats/38JourneyDataExtract28Dec2016-03Jan2017.csv\n-rw-r--r--   3 zeppelin hdfs   19106889 2019-01-14 01:44 /user/hadoop/usage-stats/39JourneyDataExtract04Jan2017-10Jan2017.csv\n-rw-r--r--   3 zeppelin hdfs   41814096 2019-01-14 01:44 /user/hadoop/usage-stats/3a.JourneyDataExtract01Mar15-15Mar15.csv\n-rw-r--r--   3 zeppelin hdfs   42438904 2019-01-14 01:44 /user/hadoop/usage-stats/3b.JourneyDataExtract16Mar15-31Mar15.csv\n-rw-r--r--   3 zeppelin hdfs   16105427 2019-01-14 01:44 /user/hadoop/usage-stats/40JourneyDataExtract11Jan2017-17Jan2017.csv\n-rw-r--r--   3 zeppelin hdfs   19613581 2019-01-14 01:44 /user/hadoop/usage-stats/41JourneyDataExtract18Jan2017-24Jan2017.csv\n-rw-r--r--   3 zeppelin hdfs   17726211 2019-01-14 01:44 /user/hadoop/usage-stats/42JourneyDataExtract25Jan2017-31Jan2017.csv\n-rw-r--r--   3 zeppelin hdfs   18756158 2019-01-14 01:44 /user/hadoop/usage-stats/43JourneyDataExtract01Feb2017-07Feb2017.csv\n-rw-r--r--   3 zeppelin hdfs   16632899 2019-01-14 01:44 /user/hadoop/usage-stats/44JourneyDataExtract08Feb2017-14Feb2017.csv\n-rw-r--r--   3 zeppelin hdfs   21179040 2019-01-14 01:44 /user/hadoop/usage-stats/45JourneyDataExtract15Feb2017-21Feb2017.csv\n-rw-r--r--   3 zeppelin hdfs   18191104 2019-01-14 01:44 /user/hadoop/usage-stats/46JourneyDataExtract22Feb2017-28Feb2017.csv\n-rw-r--r--   3 zeppelin hdfs   19708533 2019-01-14 01:44 /user/hadoop/usage-stats/47JourneyDataExtract01Mar2017-07Mar2017.csv\n-rw-r--r--   3 zeppelin hdfs   23409196 2019-01-14 01:44 /user/hadoop/usage-stats/48JourneyDataExtract08Mar2017-14Mar2017.csv\n-rw-r--r--   3 zeppelin hdfs   10939999 2019-01-14 01:44 /user/hadoop/usage-stats/49JourneyDataExtract15Mar2017-21Mar2017.xlsx\n-rw-r--r--   3 zeppelin hdfs   51464075 2019-01-14 01:44 /user/hadoop/usage-stats/4a.JourneyDataExtract01Apr15-16Apr15.csv\n-rw-r--r--   3 zeppelin hdfs   55715516 2019-01-14 01:44 /user/hadoop/usage-stats/4b.JourneyDataExtract 17Apr15-02May15.csv\n-rw-r--r--   3 zeppelin hdfs   23600415 2019-01-14 01:44 /user/hadoop/usage-stats/50 Journey Data Extract 22Mar2017-28Mar2017.csv\n-rw-r--r--   3 zeppelin hdfs   26607449 2019-01-14 01:44 /user/hadoop/usage-stats/51 Journey Data Extract 29Mar2017-04Apr2017.csv\n-rw-r--r--   3 zeppelin hdfs   30823972 2019-01-14 01:44 /user/hadoop/usage-stats/52 Journey Data Extract 05Apr2017-11Apr2017.csv\n-rw-r--r--   3 zeppelin hdfs   22222026 2019-01-14 01:44 /user/hadoop/usage-stats/53JourneyDataExtract12Apr2017-18Apr2017.csv\n-rw-r--r--   3 zeppelin hdfs   26147246 2019-01-14 01:44 /user/hadoop/usage-stats/54JourneyDataExtract19Apr2017-25Apr2017.csv\n-rw-r--r--   3 zeppelin hdfs   23432931 2019-01-14 01:44 /user/hadoop/usage-stats/55JourneyData Extract26Apr2017-02May2017.csv\n-rw-r--r--   3 zeppelin hdfs   25584245 2019-01-14 01:44 /user/hadoop/usage-stats/56JourneyDataExtract 03May2017-09May2017.csv\n-rw-r--r--   3 zeppelin hdfs   27201854 2019-01-14 01:44 /user/hadoop/usage-stats/57JourneyDataExtract10May2017-16May2017.csv\n-rw-r--r--   3 zeppelin hdfs   25599256 2019-01-14 01:44 /user/hadoop/usage-stats/58JourneyDataExtract17May2017-23May2017.csv\n-rw-r--r--   3 zeppelin hdfs   31127688 2019-01-14 01:44 /user/hadoop/usage-stats/59JourneyDataExtract24May2017-30May2017.csv\n-rw-r--r--   3 zeppelin hdfs   48750814 2019-01-14 01:44 /user/hadoop/usage-stats/5a.JourneyDataExtract03May15-16May15.csv\n-rw-r--r--   3 zeppelin hdfs   51948160 2019-01-14 01:44 /user/hadoop/usage-stats/5b.JourneyDataExtract17May15-30May15.csv\n-rw-r--r--   3 zeppelin hdfs   28357343 2019-01-14 01:44 /user/hadoop/usage-stats/60JourneyDataExtract31May2017-06Jun2017.csv\n-rw-r--r--   3 zeppelin hdfs   30163497 2019-01-14 01:44 /user/hadoop/usage-stats/61JourneyDataExtract07Jun2017-13Jun2017.csv\n-rw-r--r--   3 zeppelin hdfs   35548875 2019-01-14 01:44 /user/hadoop/usage-stats/62JourneyDataExtract14Jun2017-20Jun2017.csv\n-rw-r--r--   3 zeppelin hdfs   30496272 2019-01-14 01:44 /user/hadoop/usage-stats/63JourneyDataExtract21Jun2017-27Jun2017.csv\n-rw-r--r--   3 zeppelin hdfs   33295260 2019-01-14 01:44 /user/hadoop/usage-stats/64JourneyDataExtract28Jun2017-04Jul2017.csv\n-rw-r--r--   3 zeppelin hdfs   34054170 2019-01-14 01:44 /user/hadoop/usage-stats/65JourneyDataExtract05Jul2017-11Jul2017.csv\n-rw-r--r--   3 zeppelin hdfs   32194296 2019-01-14 01:44 /user/hadoop/usage-stats/66JourneyDataExtract12Jul2017-18Jul2017.csv\n-rw-r--r--   3 zeppelin hdfs   27980289 2019-01-14 01:44 /user/hadoop/usage-stats/67JourneyDataExtract19Jul2017-25Jul2017.csv\n-rw-r--r--   3 zeppelin hdfs   23363051 2019-01-14 01:44 /user/hadoop/usage-stats/68JourneyDataExtract26Jul2017-31Jul2017.csv\n-rw-r--r--   3 zeppelin hdfs   27444824 2019-01-14 01:44 /user/hadoop/usage-stats/69JourneyDataExtract01Aug2017-07Aug2017.csv\n-rw-r--r--   3 zeppelin hdfs   51513415 2019-01-14 01:44 /user/hadoop/usage-stats/6aJourneyDataExtract31May15-12Jun15.csv\n-rw-r--r--   3 zeppelin hdfs   62770968 2019-01-14 01:44 /user/hadoop/usage-stats/6bJourneyDataExtract13Jun15-27Jun15.csv\n-rw-r--r--   3 zeppelin hdfs   26210762 2019-01-14 01:44 /user/hadoop/usage-stats/70JourneyDataExtract08Aug2017-14Aug2017.csv\n-rw-r--r--   3 zeppelin hdfs   30238704 2019-01-14 01:44 /user/hadoop/usage-stats/71JourneyDataExtract15Aug2017-22Aug2017.csv\n-rw-r--r--   3 zeppelin hdfs   28921544 2019-01-14 01:44 /user/hadoop/usage-stats/72JourneyDataExtract23Aug2017-29Aug2017.csv\n-rw-r--r--   3 zeppelin hdfs   25301473 2019-01-14 01:44 /user/hadoop/usage-stats/73JourneyDataExtract30Aug2017-05Sep2017.csv\n-rw-r--r--   3 zeppelin hdfs   24275323 2019-01-14 01:44 /user/hadoop/usage-stats/74JourneyDataExtract06Sep2017-12Sep2017.csv\n-rw-r--r--   3 zeppelin hdfs   25497631 2019-01-14 01:44 /user/hadoop/usage-stats/75JourneyDataExtract13Sep2017-19Sep2017.csv\n-rw-r--r--   3 zeppelin hdfs   27743176 2019-01-14 01:44 /user/hadoop/usage-stats/76JourneyDataExtract20Sep2017-26Sep2017.csv\n-rw-r--r--   3 zeppelin hdfs   26348497 2019-01-14 01:44 /user/hadoop/usage-stats/77JourneyDataExtract27Sep2017-03Oct2017.csv\n-rw-r--r--   3 zeppelin hdfs   27510237 2019-01-14 01:44 /user/hadoop/usage-stats/78JourneyDataExtract04Oct2017-10Oct2017.csv\n-rw-r--r--   3 zeppelin hdfs   28322922 2019-01-14 01:44 /user/hadoop/usage-stats/79JourneyDataExtract11Oct2017-17Oct2017.csv\n-rw-r--r--   3 zeppelin hdfs   69560935 2019-01-14 01:44 /user/hadoop/usage-stats/7a.JourneyDataExtract28Jun15-11Jul15.csv\n-rw-r--r--   3 zeppelin hdfs   57317508 2019-01-14 01:44 /user/hadoop/usage-stats/7b.JourneyDataExtract12Jul15-25Jul15.csv\n-rw-r--r--   3 zeppelin hdfs   23390665 2019-01-14 01:44 /user/hadoop/usage-stats/80JourneyDataExtract18Oct2017-24Oct2017.csv\n-rw-r--r--   3 zeppelin hdfs   25260806 2019-01-14 01:44 /user/hadoop/usage-stats/81JourneyDataExtract25Oct2017-31Oct2017.csv\n-rw-r--r--   3 zeppelin hdfs   24124382 2019-01-14 01:44 /user/hadoop/usage-stats/82JourneyDataExtract01Nov2017-07Nov2017.csv\n-rw-r--r--   3 zeppelin hdfs   21684181 2019-01-14 01:44 /user/hadoop/usage-stats/83JourneyDataExtract08Nov2017-14Nov2017.csv\n-rw-r--r--   3 zeppelin hdfs   21630715 2019-01-14 01:44 /user/hadoop/usage-stats/84JourneyDataExtract15Nov2017-21Nov2017.csv\n-rw-r--r--   3 zeppelin hdfs   21045620 2019-01-14 01:44 /user/hadoop/usage-stats/85JourneyDataExtract22Nov2017-28Nov2017.csv\n-rw-r--r--   3 zeppelin hdfs   19704514 2019-01-14 01:44 /user/hadoop/usage-stats/86JourneyDataExtract29Nov2017-05Dec2017.csv\n-rw-r--r--   3 zeppelin hdfs   16113127 2019-01-14 01:44 /user/hadoop/usage-stats/87JourneyDataExtract06Dec2017-12Dec2017.csv\n-rw-r--r--   3 zeppelin hdfs   15695037 2019-01-14 01:44 /user/hadoop/usage-stats/88JourneyDataExtract13Dec2017-19Dec2017.csv\n-rw-r--r--   3 zeppelin hdfs   13306018 2019-01-14 01:44 /user/hadoop/usage-stats/89JourneyDataExtract20Dec2017-26Dec2017.csv\n-rw-r--r--   3 zeppelin hdfs   59614317 2019-01-14 01:44 /user/hadoop/usage-stats/8a-Journey-Data-Extract-26Jul15-07Aug15.csv\n-rw-r--r--   3 zeppelin hdfs   62706885 2019-01-14 01:44 /user/hadoop/usage-stats/8b-Journey-Data-Extract-08Aug15-22Aug15.csv\n-rw-r--r--   3 zeppelin hdfs    8384731 2019-01-14 01:44 /user/hadoop/usage-stats/90JourneyDataExtract27Dec2017-02Jan2018.csv\n-rw-r--r--   3 zeppelin hdfs   16006442 2019-01-14 01:44 /user/hadoop/usage-stats/91JourneyDataExtract03Jan2018-09Jan2018.csv\n-rw-r--r--   3 zeppelin hdfs   18618252 2019-01-14 01:44 /user/hadoop/usage-stats/92JourneyDataExtract10Jan2018-16Jan2018.csv\n-rw-r--r--   3 zeppelin hdfs   17591748 2019-01-14 01:44 /user/hadoop/usage-stats/93JourneyDataExtract17Jan2018-23Jan2018.csv\n-rw-r--r--   3 zeppelin hdfs   19317042 2019-01-14 01:44 /user/hadoop/usage-stats/94JourneyDataExtract24Jan2018-30Jan2018.csv\n-rw-r--r--   3 zeppelin hdfs   17621910 2019-01-14 01:44 /user/hadoop/usage-stats/95JourneyDataExtract31Jan2018-06Feb2018.csv\n-rw-r--r--   3 zeppelin hdfs   17072972 2019-01-14 01:44 /user/hadoop/usage-stats/96JourneyDataExtract07Feb2018-13Feb2018.csv\n-rw-r--r--   3 zeppelin hdfs   18701361 2019-01-14 01:44 /user/hadoop/usage-stats/97JourneyDataExtract14Feb2018-20Feb2018.csv\n-rw-r--r--   3 zeppelin hdfs   17237378 2019-01-14 01:44 /user/hadoop/usage-stats/98JourneyDataExtract21Feb2018-27Feb2018.csv\n-rw-r--r--   3 zeppelin hdfs   11650126 2019-01-14 01:44 /user/hadoop/usage-stats/99JourneyDataExtract28Feb2018-06Mar2018.csv\n-rw-r--r--   3 zeppelin hdfs   43178453 2019-01-14 01:44 /user/hadoop/usage-stats/9a-Journey-Data-Extract-23Aug15-05Sep15.csv\n-rw-r--r--   3 zeppelin hdfs   50958478 2019-01-14 01:44 /user/hadoop/usage-stats/9b-Journey-Data-Extract-06Sep15-19Sep15.csv\n-rw-r--r--   3 zeppelin hdfs  225391187 2019-01-14 01:44 /user/hadoop/usage-stats/cyclehireusagestats-2012.zip\n-rw-r--r--   3 zeppelin hdfs  183134189 2019-01-14 01:44 /user/hadoop/usage-stats/cyclehireusagestats-2013.zip\n-rw-r--r--   3 zeppelin hdfs  225215129 2019-01-14 01:44 /user/hadoop/usage-stats/cyclehireusagestats-2014.zip\n-rw-r--r--   3 zeppelin hdfs      10776 2019-01-14 01:44 /user/hadoop/usage-stats/cycling-load.json\n"}]},"apps":[],"jobName":"paragraph_1547070693419_2079308926","id":"20190109-225133_747894820","dateCreated":"2019-01-09T22:51:33+0100","dateStarted":"2019-01-14T01:43:36+0100","dateFinished":"2019-01-14T01:44:56+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4437"},{"title":"Data Munging of Cycle Usage","text":"%spark2\nspark.version\n","user":"admin","dateUpdated":"2019-01-14T16:54:18+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: String = 2.3.1.3.0.0.0-1634\n"}]},"apps":[],"jobName":"paragraph_1547070699928_-1720361121","id":"20190109-225139_1741151398","dateCreated":"2019-01-09T22:51:39+0100","dateStarted":"2019-01-14T15:47:56+0100","dateFinished":"2019-01-14T15:47:57+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4438"},{"text":"%spark2.pyspark\n\nrdd_usage = spark.read.csv(\"/user/hadoop/usage-stats/*.csv\", header=True)\n#Took 4 seconds to read 38.122.372 lines\n#38.122.372 - 1 rows\n#rdd_usage.schema.names\nprint(rdd_usage.count())\nrdd_usage.show()\n\nrdd_usage = rdd_usage.na.fill(0)\n#sqlContext.clearCache()\n#rdd_usage.unpersist()","user":"admin","dateUpdated":"2019-01-15T22:24:39+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"38122372\n+---------+--------+-------+----------------+-------------+--------------------+----------------+---------------+--------------------+\n|Rental Id|Duration|Bike Id|        End Date|EndStation Id|     EndStation Name|      Start Date|StartStation Id|   StartStation Name|\n+---------+--------+-------+----------------+-------------+--------------------+----------------+---------------+--------------------+\n| 52538879|     660|    395|01/04/2016 00:11|          137|Bourne Street, Be...|01/04/2016 00:00|            573|Limerston Street,...|\n| 52538876|     420|  12931|01/04/2016 00:07|          507|Clarkson Street, ...|01/04/2016 00:00|            399|Brick Lane Market...|\n| 52538877|     420|   7120|01/04/2016 00:07|          507|Clarkson Street, ...|01/04/2016 00:00|            399|Brick Lane Market...|\n| 52538878|     300|   1198|01/04/2016 00:05|          616|Aintree Street, F...|01/04/2016 00:00|            599|Manbre Road, Hamm...|\n| 52538874|    1260|  10739|01/04/2016 00:21|          486|Granby Street, Sh...|01/04/2016 00:00|            135|Clerkenwell Green...|\n| 52538875|    1260|  10949|01/04/2016 00:21|          486|Granby Street, Sh...|01/04/2016 00:00|            135|Clerkenwell Green...|\n| 52538880|     540|   8831|01/04/2016 00:09|          411|Walworth Road, El...|01/04/2016 00:00|            193|Bankside Mix, Ban...|\n| 52538881|     600|   8778|01/04/2016 00:11|          770|Gwendwr Road, Wes...|01/04/2016 00:01|            266|Queen's Gate (Nor...|\n| 52538882|     540|    700|01/04/2016 00:10|          294|St. George's Squa...|01/04/2016 00:01|            137|Bourne Street, Be...|\n| 52538883|    3000|   5017|01/04/2016 00:51|           39|Shoreditch High S...|01/04/2016 00:01|            456|Parkway, Camden Town|\n| 52538885|     240|   4359|01/04/2016 00:06|          445|Cheshire Street, ...|01/04/2016 00:02|            444|Bethnal Green Gar...|\n| 52538884|    5340|   2801|01/04/2016 01:31|          288|Elizabeth Bridge,...|01/04/2016 00:02|            288|Elizabeth Bridge,...|\n| 52538887|     300|   9525|01/04/2016 00:08|          592|Bishop's Bridge R...|01/04/2016 00:03|            265|Southwick Street,...|\n| 52538888|     840|   8410|01/04/2016 00:17|          360|Howick Place, Wes...|01/04/2016 00:03|            174|      Strand, Strand|\n| 52538886|     600|  12206|01/04/2016 00:13|          607|Putney Bridge Sta...|01/04/2016 00:03|            738|Imperial Road, Sa...|\n| 52538891|     120|   2998|01/04/2016 00:06|          384|Marloes Road, Ken...|01/04/2016 00:04|            157|Wright's Lane, Ke...|\n| 52538893|     300|  10970|01/04/2016 00:09|          242|Beaumont Street, ...|01/04/2016 00:04|            239|Warren Street Sta...|\n| 52538890|    1200|   9350|01/04/2016 00:24|          517| Ford Road, Old Ford|01/04/2016 00:04|            789|Podium, Queen Eli...|\n| 52538889|    1800|   7005|01/04/2016 00:34|          583|Abingdon Green, W...|01/04/2016 00:04|            354|Northumberland Av...|\n| 52538892|    1800|   9368|01/04/2016 00:34|          583|Abingdon Green, W...|01/04/2016 00:04|            354|Northumberland Av...|\n+---------+--------+-------+----------------+-------------+--------------------+----------------+---------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=179","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=180","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=181","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=182","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=183"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1547426769607_-1827823501","id":"20190114-014609_187056425","dateCreated":"2019-01-14T01:46:09+0100","dateStarted":"2019-01-15T22:24:39+0100","dateFinished":"2019-01-15T22:25:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4439"},{"text":"%spark2.pyspark\n##Dont use toPandas -> trying to load everything in one Workers Node\n#d = rdd_usage.toPandas()\n#rdd_usage.select(\"\").show()\n\n#rdd_usage.DataFrame\nrdd_usage.dropna(subset=[\"StartStation Id\", \"EndStation Id\", \"Start Date\", \"End Date\"])\n\n\n#Change column types of ID columns\nrdd_usage = rdd_usage.withColumn(\"EndStation ID\", rdd_usage[\"EndStation ID\"].cast(\"int\"))\nrdd_usage = rdd_usage.withColumn(\"StartStation ID\", rdd_usage[\"StartStation ID\"].cast(\"int\"))\n\n#Prevent StartStation ID = EndStation ID\nrdd_usage = rdd_usage[rdd_usage[\"StartStation Id\"] != rdd_usage[\"EndStation Id\"]]\n\n\n#Keep only relevant columns\nrdd_usage = rdd_usage[\"Start Date\", \"StartStation Id\", \"End Date\", \"EndStation Id\", \"Duration\"]\n\n#Remove duplicates\nrdd_usage = rdd_usage.dropDuplicates()\n\nrdd_usage.printSchema()\n\n","user":"admin","dateUpdated":"2019-01-15T22:24:44+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Start Date: string (nullable = true)\n |-- StartStation Id: integer (nullable = true)\n |-- End Date: string (nullable = true)\n |-- EndStation Id: integer (nullable = true)\n |-- Duration: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1547480614783_-1415327386","id":"20190114-164334_323976923","dateCreated":"2019-01-14T16:43:34+0100","dateStarted":"2019-01-15T22:24:44+0100","dateFinished":"2019-01-15T22:25:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4440"},{"text":"%spark2.pyspark\nrdd_usage.count()","user":"admin","dateUpdated":"2019-01-15T22:24:54+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"34137270\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=184"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1547559816932_-2135213792","id":"20190115-144336_965591530","dateCreated":"2019-01-15T14:43:36+0100","dateStarted":"2019-01-15T22:25:46+0100","dateFinished":"2019-01-15T22:27:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4441"},{"text":"%md\n#### Getting rentalstation coordinates\n\nTfL have a live \"cycle hire updates\" feed which lists information for each cycle hire station, updated once every minute. \nProvides full details of rentail stations `name`, `ID`, `lat/lon`, and `capacity`.\n","user":"admin","dateUpdated":"2019-01-15T14:49:39+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Getting rentalstation coordinates</h4>\n<p>TfL have a live &ldquo;cycle hire updates&rdquo; feed which lists information for each cycle hire station, updated once every minute.\n<br  />Provides full details of rentail stations <code>name</code>, <code>ID</code>, <code>lat/lon</code>, and <code>capacity</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1547560174383_670254852","id":"20190115-144934_1707563298","dateCreated":"2019-01-15T14:49:34+0100","dateStarted":"2019-01-15T14:49:39+0100","dateFinished":"2019-01-15T14:49:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4442"},{"text":"%spark2.pyspark\nrdd_usage.show()","user":"admin","dateUpdated":"2019-01-15T22:24:57+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+---------------+----------------+-------------+--------+\n|      Start Date|StartStation Id|        End Date|EndStation Id|Duration|\n+----------------+---------------+----------------+-------------+--------+\n|01/04/2016 02:16|            709|01/04/2016 02:36|          750|    1200|\n|01/04/2016 03:39|            334|01/04/2016 04:56|           48|    4620|\n|01/04/2016 04:44|            452|01/04/2016 05:00|          556|     960|\n|01/04/2016 05:43|            701|01/04/2016 05:55|          231|     720|\n|01/04/2016 06:25|            223|01/04/2016 06:38|          703|     780|\n|01/04/2016 06:53|            214|01/04/2016 07:08|           40|     900|\n|01/04/2016 07:01|            116|01/04/2016 07:03|          391|     120|\n|01/04/2016 07:05|            355|01/04/2016 07:18|          751|     780|\n|01/04/2016 07:26|             70|01/04/2016 07:48|          411|    1320|\n|01/04/2016 07:28|             74|01/04/2016 07:35|          268|     420|\n|01/04/2016 07:32|            565|01/04/2016 07:38|          251|     360|\n|01/04/2016 07:33|            199|01/04/2016 07:38|           46|     300|\n|01/04/2016 07:35|             41|01/04/2016 07:55|          191|    1200|\n|01/04/2016 07:35|             46|01/04/2016 07:43|          251|     480|\n|01/04/2016 07:37|            374|01/04/2016 07:59|          292|    1320|\n|01/04/2016 07:53|            154|01/04/2016 08:08|           55|     900|\n|01/04/2016 07:59|            483|01/04/2016 08:15|          115|     960|\n|01/04/2016 08:02|            105|01/04/2016 08:22|           14|    1200|\n|01/04/2016 08:04|            405|01/04/2016 08:10|          150|     360|\n|01/04/2016 08:05|            545|01/04/2016 08:17|          313|     720|\n+----------------+---------------+----------------+-------------+--------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=185"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1547426767340_299483322","id":"20190114-014607_100915344","dateCreated":"2019-01-14T01:46:07+0100","dateStarted":"2019-01-15T22:25:47+0100","dateFinished":"2019-01-15T22:29:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4443"},{"text":"%spark2.pyspark\nimport requests\nfrom xml.etree import ElementTree as ET\nimport pandas as pd\n\n#Getting the coordinates tuples of the rental stations\nsite = \"https://tfl.gov.uk/tfl/syndication/feeds/cycle-hire/livecyclehireupdates.xml\"\nresponse = requests.get(site)\nroot = ET.fromstring(response.content)\n\n#fetch relevant information\nid_list = [int(root[i][0].text) for i in range(0, len(root))]\nname_list = [root[i][1].text for i in range(0, len(root))]\nlat_list = [float(root[i][3].text) for i in range(0, len(root))]\nlon_list = [float(root[i][4].text) for i in range(0, len(root))]\ncapacity_list = [int(root[i][12].text) for i in range(0, len(root))]\n\n#zip tuples\nall_locs = pd.DataFrame(list(zip(name_list, id_list, lat_list, \n                                 lon_list, capacity_list)), columns = [\"name\",\"id\",\"lat\",\"lon\",\"capacity\"])\n\n#zip\nall_locs.to_csv('/home/hadoop/TFL_Cycling_Data_raw/rental_stations_saved.csv', header=True, index=None)\nprint(all_locs.shape)\n\n#786 unique rental stations\nall_locs.head()\n\n","user":"admin","dateUpdated":"2019-01-15T22:24:58+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(786, 5)\n                                   name  id        lat       lon  capacity\n0            River Street , Clerkenwell   1  51.529163 -0.109971        19\n1        Phillimore Gardens, Kensington   2  51.499607 -0.197574        37\n2  Christopher Street, Liverpool Street   3  51.521284 -0.084606        32\n3       St. Chad's Street, King's Cross   4  51.530059 -0.120974        23\n4         Sedding Street, Sloane Square   5  51.493130 -0.156876        27\n"}]},"apps":[],"jobName":"paragraph_1547560215761_3363513","id":"20190115-145015_195911643","dateCreated":"2019-01-15T14:50:15+0100","dateStarted":"2019-01-15T22:27:56+0100","dateFinished":"2019-01-15T22:29:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4444"},{"text":"%sh\n\n# Remove old dataset if already exists in hadoop /user/hadoop directory\nd_name=/home/hadoop/TFL_Cycling_Data_raw/rental_stations_saved.csv\n\nhdfs dfs -test -f $d_name\n    if [ $? != 0 ]\n            then\n                echo \"Move folder to HDFS...\"\n                hdfs dfs -put /home/hadoop/TFL_Cycling_Data_raw/rental_stations_saved.csv /user/hadoop/\n                echo \"Folder successfully uploaded to HDFS\"\n                hdfs dfs -ls /user/hadoop/rental_stations_saved.csv\n            else\n                echo \"Directory already present in HDFS\"\n                echo \"Move folder to trash\"\n                hdfs dfs -rm -r -skipTrash $d_name\n                echo \"$d_name\" \"has been deleted\"\n    fi\n","user":"admin","dateUpdated":"2019-01-15T22:25:01+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Move folder to HDFS...\nput: `/user/hadoop/rental_stations_saved.csv': File exists\nFolder successfully uploaded to HDFS\n-rw-r--r--   3 zeppelin hdfs      47382 2019-01-15 19:34 /user/hadoop/rental_stations_saved.csv\n"}]},"apps":[],"jobName":"paragraph_1547577084982_-1969096342","id":"20190115-193124_834255187","dateCreated":"2019-01-15T19:31:24+0100","dateStarted":"2019-01-15T22:25:01+0100","dateFinished":"2019-01-15T22:25:17+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4445"},{"text":"%md\nRemark: `Livecyclehireupdates.xml` contains also following attributes:\n* `installed`\n* `locked`\n* `installDate`\n* `nbBikes`\n* `nbEmptyDocks`\n* `nbDocks`\n\nGiven that there are 786 stations across London (at least at the time of writing), this allows for 786 * 785 = 617.010 possible journey combinations if we ignore those that start and end at the same station","user":"admin","dateUpdated":"2019-01-15T15:46:13+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Remark: <code>Livecyclehireupdates.xml</code> contains also following attributes:</p>\n<ul>\n<li><code>installed</code></li>\n<li><code>locked</code></li>\n<li><code>installDate</code></li>\n<li><code>nbBikes</code></li>\n<li><code>nbEmptyDocks</code></li>\n<li><code>nbDocks</code></li>\n</ul>\n<p>Given that there are 786 stations across London (at least at the time of writing), this allows for 786 * 785 = 617.010 possible journey combinations if we ignore those that start and end at the same station</p>\n"}]},"apps":[],"jobName":"paragraph_1547560766897_1240720109","id":"20190115-145926_873610409","dateCreated":"2019-01-15T14:59:26+0100","dateStarted":"2019-01-15T15:46:13+0100","dateFinished":"2019-01-15T15:46:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4446"},{"text":"%spark2.pyspark\nfrom pyspark.sql.functions import *\n\n#Load saved rental stations location\nrdd_rental_locs = spark.read.csv(\"/user/hadoop/rental_stations_saved.csv\", header=True)\nrdd_rental_locs.printSchema()\nrdd_rental_locs.show()\nrdd_rental_locs.count()\n\n#Drop duplicated Station IDs\nunq_rentals = rdd_usage[\"StartStation Id\", \"EndStation Id\", \"Duration\"]\nprint(\"With duplicates: \", unq_rentals.count())\nunq_rentals = unq_rentals.dropDuplicates()\nprint(\"Without duplicates: \", unq_rentals.count())\n\n##Merging\n#Merge cycle_usage RDD with RDD from livecyclehireupdates for StartStations\nta = unq_rentals.alias('ta')\ntb = rdd_rental_locs.alias('tb')\nunq_rentals = ta.join(tb, ta[\"StartStation Id\"] == tb.id)\n#Drop unncessary id column and rename name to StartStation Address\n#Dropping column requires to reorganize the RDD\nunq_rentals = unq_rentals.drop('id')\nunq_rentals = unq_rentals.withColumnRenamed(\"name\", \"StartStation Address\").withColumnRenamed(\"lat\", \"StartStation  latitude\").withColumnRenamed(\"lon\", \"StartStation longitude\").withColumnRenamed(\"capacity\", \"StartStation capacity\")\nunq_rentals.show()\n\n#for EndStations\nta = unq_rentals.alias('ta')\nunq_rentals = ta.join(tb, ta[\"EndStation Id\"] == tb.id)\nunq_rentals = unq_rentals.drop(\"id\")\nunq_rentals = unq_rentals.withColumnRenamed(\"name\", \"EndStation Address\").withColumnRenamed(\"lat\", \"EndStation  latitude\").withColumnRenamed(\"lon\", \"EndStation longitude\").withColumnRenamed(\"capacity\", \"EndStation capacity\")\nunq_rentals.show()\n                   \n\n","user":"admin","dateUpdated":"2019-01-15T22:25:18+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- name: string (nullable = true)\n |-- id: string (nullable = true)\n |-- lat: string (nullable = true)\n |-- lon: string (nullable = true)\n |-- capacity: string (nullable = true)\n\n+--------------------+---+-----------+------------+--------+\n|                name| id|        lat|         lon|capacity|\n+--------------------+---+-----------+------------+--------+\n|River Street , Cl...|  1|51.52916347|-0.109970527|      19|\n|Phillimore Garden...|  2|51.49960695|-0.197574246|      37|\n|Christopher Stree...|  3|51.52128377|-0.084605692|      32|\n|St. Chad's Street...|  4|51.53005939|-0.120973687|      23|\n|Sedding Street, S...|  5|   51.49313|   -0.156876|      27|\n|Broadcasting Hous...|  6|51.51811784|-0.144228881|      18|\n|Charlbert Street,...|  7|51.53430039|  -0.1680743|      16|\n|Maida Vale, Maida...|  8|  51.529857| -0.18348604|      39|\n|New Globe Walk, B...|  9| 51.5073853|-0.096440751|      19|\n|Park Street, Bank...| 10|51.50597426|-0.092754157|      18|\n|Brunswick Square,...| 11|51.52395143|-0.122502346|      24|\n|Malet Street, Blo...| 12|51.52168078|-0.130431727|      49|\n|Scala Street, Fit...| 13|51.51991453|-0.136039674|      21|\n|Belgrove Street ,...| 14|51.52994371|-0.123616824|      48|\n|Great Russell Str...| 15|51.51772703|-0.127854211|      26|\n|Cartwright Garden...| 16|51.52635795|-0.125979294|      22|\n|Hatton Wall, Holborn| 17| 51.5216612|-0.109006325|      26|\n|Drury Lane, Coven...| 18|51.51477076| -0.12221963|      27|\n|Taviton Street, B...| 19|51.52505093|-0.131161087|      30|\n|Drummond Street ,...| 20|  51.527326| -0.13605286|      28|\n+--------------------+---+-----------+------------+--------+\nonly showing top 20 rows\n\n('With duplicates: ', 34137270)\n('Without duplicates: ', 6894389)\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+\n|StartStation Id|EndStation Id|Duration|StartStation Address|StartStation  latitude|StartStation longitude|StartStation capacity|\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+\n|            229|          421|    1380|Whitehall Place, ...|           51.50654321|          -0.123179697|                   24|\n|              5|          746|     480|Sedding Street, S...|              51.49313|             -0.156876|                   27|\n|            292|          405|     480|Montpelier Street...|           51.49888404|          -0.165471605|                   16|\n|            696|          635|      60|Charing Cross Hos...|           51.48728535|          -0.217995921|                   21|\n|            691|          376|    1620|Erin Close, Walha...|           51.47946386|          -0.195777222|                   24|\n|            404|          303|     900|Palace Gate, Kens...|           51.50204238|          -0.184400221|                   13|\n|             38|          113|     480|Abingdon Villas, ...|            51.4973875|          -0.197245586|                   17|\n|            331|           55|     180|Bunhill Row, Moor...|           51.52085887|          -0.089887855|                   30|\n|            768|          723|    1200|Clapham Common No...|           51.46134382|          -0.159322467|                   37|\n|            250|          632|     660|Royal Avenue 1, C...|             51.489932|             -0.162727|                   10|\n|            481|          785|    5640|Saunders Ness Roa...|             51.487129|             -0.009001|                   35|\n|            605|           47|     540|Seymour Place, Ma...|             51.520331|             -0.163667|                   29|\n|            235|          146|    1260|Kennington Road  ...|           51.49571828|          -0.110889274|                   36|\n|            511|          451|    1020|Sutton Street, Sh...|             51.511066|             -0.053558|                   33|\n|            223|          217|    1620|Rodney Road , Wal...|           51.49148474|          -0.090220911|                   24|\n|            404|          191|     600|Palace Gate, Kens...|           51.50204238|          -0.184400221|                   13|\n|            660|          618|     780|West Kensington S...|           51.49087074|          -0.206029743|                   22|\n|            750|          709|    1380|Culvert Road, Bat...|            51.4710956|          -0.157850096|                   27|\n|             99|          182|     540|Old Quebec Street...|           51.51457763|          -0.158264483|                   16|\n|            136|          558|    1200|Queen Victoria St...|           51.51196176|          -0.097441687|                   32|\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+\nonly showing top 20 rows\n\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+--------------------+--------------------+--------------------+-------------------+\n|StartStation Id|EndStation Id|Duration|StartStation Address|StartStation  latitude|StartStation longitude|StartStation capacity|  EndStation Address|EndStation  latitude|EndStation longitude|EndStation capacity|\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+--------------------+--------------------+--------------------+-------------------+\n|            229|          421|    1380|Whitehall Place, ...|           51.50654321|          -0.123179697|                   24|Southwark Station...|           51.504044|           -0.104778|                 45|\n|              5|          746|     480|Sedding Street, S...|              51.49313|             -0.156876|                   27|Lots Road, West C...|          51.4795738|         -0.17903854|                 24|\n|            292|          405|     480|Montpelier Street...|           51.49888404|          -0.165471605|                   16|Gloucester Road S...|         51.49418566|         -0.18267094|                 15|\n|            696|          635|      60|Charing Cross Hos...|           51.48728535|          -0.217995921|                   21|Greyhound Road, H...|         51.48606206|        -0.214428378|                 37|\n|            691|          376|    1620|Erin Close, Walha...|           51.47946386|          -0.195777222|                   24|Millbank Tower, P...|         51.49188409|        -0.125674815|                 24|\n|            404|          303|     900|Palace Gate, Kens...|           51.50204238|          -0.184400221|                   13|Albert Gate, Hyde...|         51.50295379|        -0.158456089|                 28|\n|             38|          113|     480|Abingdon Villas, ...|            51.4973875|          -0.197245586|                   17|Gloucester Road (...|         51.49646288|        -0.183289032|                 19|\n|            331|           55|     180|Bunhill Row, Moor...|           51.52085887|          -0.089887855|                   30|Finsbury Circus, ...|         51.51707521|        -0.086685542|                 33|\n|            768|          723|    1200|Clapham Common No...|           51.46134382|          -0.159322467|                   37|Stephendale Road,...|         51.46822047|        -0.190346493|                 48|\n|            250|          632|     660|Royal Avenue 1, C...|             51.489932|             -0.162727|                   10|Sheepcote Lane, B...|         51.47053858|        -0.163041605|                 28|\n|            481|          785|    5640|Saunders Ness Roa...|             51.487129|             -0.009001|                   35|Aquatic Centre, Q...|            51.54094|        -0.010510565|                 64|\n|            605|           47|     540|Seymour Place, Ma...|             51.520331|             -0.163667|                   29|Warwick Avenue St...|         51.52334476|        -0.183846408|                 19|\n|            235|          146|    1260|Kennington Road  ...|           51.49571828|          -0.110889274|                   36|Vauxhall Bridge ,...|         51.48836528|        -0.129361842|                 35|\n|            511|          451|    1020|Sutton Street, Sh...|             51.511066|             -0.053558|                   33|Hermitage Court, ...|           51.504719|           -0.063531|                 16|\n|            223|          217|    1620|Rodney Road , Wal...|           51.49148474|          -0.090220911|                   24|Wormwood Street, ...|         51.51615461|        -0.082422399|                 16|\n|            404|          191|     600|Palace Gate, Kens...|           51.50204238|          -0.184400221|                   13|Hyde Park Corner,...|         51.50311799|        -0.153520935|                 28|\n|            660|          618|     780|West Kensington S...|           51.49087074|          -0.206029743|                   22|Eel Brook Common,...|         51.47625965|        -0.193254007|                 24|\n|            750|          709|    1380|Culvert Road, Bat...|            51.4710956|          -0.157850096|                   27|Montserrat Road ,...|         51.46321128|        -0.215550761|                 23|\n|             99|          182|     540|Old Quebec Street...|           51.51457763|          -0.158264483|                   16|Bell Street , Mar...|         51.52202903|        -0.165842551|                 18|\n|            136|          558|    1200|Queen Victoria St...|           51.51196176|          -0.097441687|                   32|Page Street, West...|           51.493978|           -0.127554|                 24|\n+---------------+-------------+--------+--------------------+----------------------+----------------------+---------------------+--------------------+--------------------+--------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=186","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=187","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=188","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=189","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=190","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=191","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=192","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=193","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=194"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1547576904996_821758590","id":"20190115-192824_898151378","dateCreated":"2019-01-15T19:28:24+0100","dateStarted":"2019-01-15T22:29:50+0100","dateFinished":"2019-01-15T22:40:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4447"},{"text":"%spark2.pyspark\n\n#Write back on HDFS in one single csv file\nunq_rentals.coalesce(1).write.csv(\"/user/hadoop/usage_stats_prepared\", header=True)","user":"admin","dateUpdated":"2019-01-15T23:05:40+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=197","http://i-hadoop-01.informatik.hs-ulm.de:4040/jobs/job?id=198"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1547120201182_525685097","id":"20190110-123641_592817625","dateCreated":"2019-01-10T12:36:41+0100","dateStarted":"2019-01-15T22:45:48+0100","dateFinished":"2019-01-15T22:49:14+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4448"},{"text":"%sh\nhdfs dfs -du -s -h /user/hadoop/usage-stats\n","user":"admin","dateUpdated":"2019-01-15T23:03:07+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"17M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/95JourneyDataExtract31Jan2018-06Feb2018.csv\n20M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/36JourneyDataExtract14Dec2016-20Dec2016.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/22JourneyDataExtract07Sep2016-13Sep2016.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/20JourneyDataExtract24Aug2016-30Aug2016.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/50 Journey Data Extract 22Mar2017-28Mar2017.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/11JourneyDataExtract22Jun2016-28Jun2016.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/78JourneyDataExtract04Oct2017-10Oct2017.csv\n48M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/10b-Journey-Data-Extract-04Oct15-17Oct15.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/33JourneyDataExtract23Nov2016-29Nov2016.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/84JourneyDataExtract15Nov2017-21Nov2017.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/18JourneyDataExtract10Aug2016-16Aug2016.csv\n51M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/10a-Journey-Data-Extract-20Sep15-03Oct15.csv\n40M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/3a.JourneyDataExtract01Mar15-15Mar15.csv\n32M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/02aJourneyDataExtract07Fe16-20Feb2016.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/111JourneyDataExtract23May2018-29May2018.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/126JourneyDataExtract05Sep2018-11Sep2018.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/70JourneyDataExtract08Aug2017-14Aug2017.csv\n50M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/5b.JourneyDataExtract17May15-30May15.csv\n32M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/2a.JourneyDataExtract01Feb15-14Feb15.csv\n69M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/05JourneyDataExtract01May2016-17May2016.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/106JourneyDataExtract18Apr2018-24Apr2018.csv\n16M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/44JourneyDataExtract08Feb2017-14Feb2017.csv\n200M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/2015TripDatazip.zip\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/69JourneyDataExtract01Aug2017-07Aug2017.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/72JourneyDataExtract23Aug2017-29Aug2017.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/02bJourneyDataExtract21Feb16-05Mar2016.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/108JourneyDataExtract02May2018-08May2018.csv\n38M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/12bJourneyDataExtract28Nov15-12Dec15.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/67JourneyDataExtract19Jul2017-25Jul2017.csv\n40M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/11b-Journey-Data-Extract-01Nov15-14Nov15.csv\n67M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/7a.JourneyDataExtract28Jun15-11Jul15.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/56JourneyDataExtract 03May2017-09May2017.csv\n12K\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/cycling-load.json\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/09JourneyDataExtract08Jun2016-14Jun2016.csv\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/51 Journey Data Extract 29Mar2017-04Apr2017.csv\n17M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/96JourneyDataExtract07Feb2018-13Feb2018.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/17JourneyDataExtract03Aug2016-09Aug2016.csv\n24M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/82JourneyDataExtract01Nov2017-07Nov2017.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/63JourneyDataExtract21Jun2017-27Jun2017.csv\n13M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/89JourneyDataExtract20Dec2017-26Dec2017.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/123JourneyDataExtract15Aug2018-21Aug2018.csv\n15M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/37JourneyDataExtract21Dec2016-27Dec2016.csv\n12M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/103JourneyDataExtract28Mar2018-03Apr2018.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/01b Journey Data Extract 24Jan16-06Feb16.csv\n18M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/43JourneyDataExtract01Feb2017-07Feb2017.csv\n20M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/35JourneyDataExtract07Dec2016-13Dec2016.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/41JourneyDataExtract18Jan2017-24Jan2017.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/124JourneyDataExtract22Aug2018-28Aug2018.csv\n32M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/64JourneyDataExtract28Jun2017-04Jul2017.csv\n24M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/74JourneyDataExtract06Sep2017-12Sep2017.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/13JourneyDataExtract06Jul2016-12Jul2016.csv\n60M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/8b-Journey-Data-Extract-08Aug15-22Aug15.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/32JourneyDataExtract16Nov2016-22Nov2016.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/112JourneyDataExtract30May2018-05June2018.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/24JourneyDataExtract21Sep2016-27Sep2016.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/14JourneyDataExtract13Jul2016-19Jul2016.csv\n49M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/9b-Journey-Data-Extract-06Sep15-19Sep15.csv\n215M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/cyclehireusagestats-2012.zip\n18M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/46JourneyDataExtract22Feb2017-28Feb2017.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/62JourneyDataExtract14Jun2017-20Jun2017.csv\n17M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/42JourneyDataExtract25Jan2017-31Jan2017.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/66JourneyDataExtract12Jul2017-18Jul2017.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/125JourneyDataExtract29Aug2018-04Sep2018.csv\n54M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/4b.JourneyDataExtract 17Apr15-02May15.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/61JourneyDataExtract07Jun2017-13Jun2017.csv\n18M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/97JourneyDataExtract14Feb2018-20Feb2018.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/105JourneyDataExtract11Apr2018-17Apr2018.csv\n20M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/34JourneyDataExtract30Nov2016-06Dec2016.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/13bJourneyDataExtract25Dec15-09Jan16.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/104JourneyDataExtract04Apr2018-10Apr2018.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/115JourneyDataExtract20June2018-26June2018.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/114JourneyDataExtract13June2018-19June2018.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/76JourneyDataExtract20Sep2017-26Sep2017.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/28JourneyDataExtract19Oct2016-25Oct2016.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/55JourneyData Extract26Apr2017-02May2017.csv\n50M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/6aJourneyDataExtract31May15-12Jun15.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/12aJourneyDataExtract15Nov15-27Nov15.csv\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/77JourneyDataExtract27Sep2017-03Oct2017.csv\n47M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/5a.JourneyDataExtract03May15-16May15.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/39JourneyDataExtract04Jan2017-10Jan2017.csv\n16M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/91JourneyDataExtract03Jan2018-09Jan2018.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/26JourneyDataExtract05Oct2016-11Oct2016.csv\n55M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/7b.JourneyDataExtract12Jul15-25Jul15.csv\n91M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/04JourneyDataExtract01Apr2016-30Apr2016.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/121JourneyDataExtract01Aug2018-07Aug2018.csv\n50M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/4a.JourneyDataExtract01Apr15-16Apr15.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/01bJourneyDataExtract24Jan16-06Feb16.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/127JourneyDataExtract12Sep2018-18Sep2018.csv\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/10JourneyDataExtract15Jun2016-21Jun2016.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/85JourneyDataExtract22Nov2017-28Nov2017.csv\n15M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/88JourneyDataExtract13Dec2017-19Dec2017.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/08JourneyDataExtract01Jun2016-07Jun2016.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/65JourneyDataExtract05Jul2017-11Jul2017.csv\n41M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/3b.JourneyDataExtract16Mar15-31Mar15.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/86JourneyDataExtract29Nov2017-05Dec2017.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/80JourneyDataExtract18Oct2017-24Oct2017.csv\n175M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/cyclehireusagestats-2013.zip\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/117JourneyDataExtract04July2018-10July2018.csv\n42M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/9a-Journey-Data-Extract-23Aug15-05Sep15.csv\n32M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/2b.JourneyDataExtract15Feb15-28Feb15.csv\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/29JourneyDataExtract26Oct2016-01Nov2016.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/118JourneyDataExtract11July2018-17July2018.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/21JourneyDataExtract31Aug2016-06Sep2016.csv\n11M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/38JourneyDataExtract28Dec2016-03Jan2017.csv\n18M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/31JourneyDataExtract09Nov2016-15Nov2016.csv\n60M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/6bJourneyDataExtract13Jun15-27Jun15.csv\n32M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/113JourneyDataExtract06June2018-12June2018.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/47JourneyDataExtract01Mar2017-07Mar2017.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/68JourneyDataExtract26Jul2017-31Jul2017.csv\n18M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/92JourneyDataExtract10Jan2018-16Jan2018.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/116JourneyDataExtract27June2018-03July2018.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/06JourneyDataExtract18May2016-24May2016.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/07JourneyDataExtract25May2016-31May2016.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/79JourneyDataExtract11Oct2017-17Oct2017.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/120JourneyDataExtract25July2018-31July2018.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/119JourneyDataExtract18July2018-24July2018.csv\n57M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/8a-Journey-Data-Extract-26Jul15-07Aug15.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/109JourneyDataExtract09May2018-15May2018.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/01aJourneyDataExtract10Jan16-23Jan16.csv\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/52 Journey Data Extract 05Apr2017-11Apr2017.csv\n16M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/40JourneyDataExtract11Jan2017-17Jan2017.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/58JourneyDataExtract17May2017-23May2017.csv\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/122JourneyDataExtract08Aug2018-14Aug2018.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/30JourneyDataExtract02Nov2016-08Nov2016.csv\n19M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/94JourneyDataExtract24Jan2018-30Jan2018.csv\n12M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/99JourneyDataExtract28Feb2018-06Mar2018.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/71JourneyDataExtract15Aug2017-22Aug2017.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/107JourneyDataExtract25Apr2018-01May2018.csv\n23M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/48JourneyDataExtract08Mar2017-14Mar2017.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/13aJourneyDataExtract13Dec15-24Dec15.csv\n8.0M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/90JourneyDataExtract27Dec2017-02Jan2018.csv\n43M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/11a-Journey-Data-Extract-18Oct15-31Oct15.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/45JourneyDataExtract15Feb2017-21Feb2017.csv\n27M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/25JourneyDataExtract28Sep2016-04Oct2016.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/16JourneyDataExtract27Jul2016-02Aug2016.csv\n11M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/49JourneyDataExtract15Mar2017-21Mar2017.xlsx\n30M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/59JourneyDataExtract24May2017-30May2017.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/73JourneyDataExtract30Aug2017-05Sep2017.csv\n17M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/93JourneyDataExtract17Jan2018-23Jan2018.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/81JourneyDataExtract25Oct2017-31Oct2017.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/23JourneyDataExtract14Sep2016-20Sep2016.csv\n65M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/03JourneyDataExtract06Mar2016-31Mar2016.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/75JourneyDataExtract13Sep2017-19Sep2017.csv\n22M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/53JourneyDataExtract12Apr2017-18Apr2017.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/1a.JourneyDataExtract04Jan15-17Jan15.csv\n24M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/27JourneyDataExtract12Oct2016-18Oct2016.csv\n31M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/110JourneyDataExtract16May2018-22May2018.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/60JourneyDataExtract31May2017-06Jun2017.csv\n215M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/cyclehireusagestats-2014.zip\n24M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/128JourneyDataExtract19Sep2018-25Sep2018.csv\n34M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/15JourneyDataExtract20Jul2016-26Jul2016.csv\n33M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/1b.JourneyDataExtract18Jan15-31Jan15.csv\n28M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/19JourneyDataExtract17Aug2016-23Aug2016.csv\n29M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/12JourneyDataExtract29Jun2016-05Jul2016.csv\n17M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/98JourneyDataExtract21Feb2018-27Feb2018.csv\n25M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/54JourneyDataExtract19Apr2017-25Apr2017.csv\n21M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/83JourneyDataExtract08Nov2017-14Nov2017.csv\n16M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/87JourneyDataExtract06Dec2017-12Dec2017.csv\n212M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/2016TripDataZip.zip\n26M\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats/57JourneyDataExtract10May2017-16May2017.csv\n5.4G\t/home/hadoop/TFL_Cycling_Data_raw/usage-stats\n5.4G\ttotal\n"}]},"apps":[],"jobName":"paragraph_1547589573160_546829005","id":"20190115-225933_1888173506","dateCreated":"2019-01-15T22:59:33+0100","dateStarted":"2019-01-15T23:00:19+0100","dateFinished":"2019-01-15T23:00:19+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4449"},{"text":"%sh\nhdfs dfs -du -h /user/hadoop/usage_stats_prepared.csv\n","user":"admin","dateUpdated":"2019-01-15T23:06:24+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0        0      /user/hadoop/usage_stats_prepared.csv/_SUCCESS\n796.6 M  2.3 G  /user/hadoop/usage_stats_prepared.csv/part-00000-c4cf8166-4a49-418a-8edb-6841ce2c6181-c000.csv\n"}]},"apps":[],"jobName":"paragraph_1547589274638_835876524","id":"20190115-225434_263897178","dateCreated":"2019-01-15T22:54:34+0100","dateStarted":"2019-01-15T23:06:24+0100","dateFinished":"2019-01-15T23:06:27+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4450"},{"text":"%md\n#### Summary ####\n1. The sizing problem can be well handled by Spark\n2. The HDP is working and storing the cycle-usage files on HDFS\n3. For plotting tasks packages like folium or seaborn can not be used with Spark DataFrame\n    * Using Jupyter notebook on local computer\n","user":"admin","dateUpdated":"2019-01-15T22:54:21+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Summary</h4>\n<ol>\n<li>The sizing problem can be well handled by Spark</li>\n<li>The HDP is working and storing the cycle-usage files on HDFS</li>\n<li>For plotting tasks packages like folium or seaborn can not be used with Spark DataFrame<ul>\n<li>Using Jupyter notebook on local computer</li>\n</ul>\n</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1547588516983_260692071","id":"20190115-224156_1577921816","dateCreated":"2019-01-15T22:41:56+0100","dateStarted":"2019-01-15T22:54:21+0100","dateFinished":"2019-01-15T22:54:21+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4451"}],"name":"File sizing","id":"2E37HAZ7S","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}